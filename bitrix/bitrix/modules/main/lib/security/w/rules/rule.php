<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1581458266']= array(base64_decode(''.'aXNf'.'c3Ry'.'aW5n'),base64_decode('c'.'3Ry'.'dG9'.'sb3'.'dlcg=='),base64_decode('aXN'.'fYXJyYXk'.'='),base64_decode('aXNfc3Ry'.'aW5'.'n'),base64_decode('Z'.'3'.'pk'.'ZWNvZGU='),base64_decode('Ym'.'FzZTY0'.'X'.'2RlY29k'.'ZQ=='),base64_decode(''.'dXJsZGVjb2'.'Rl'),base64_decode('YXJyY'.'Xl'.'fc'.'mV2ZX'.'JzZQ='.'='),base64_decode('Z3'.'plbmNvZGU='),base64_decode('YmFzZTY0'.'X2Vu'.'Y2'.'9k'.'Z'.'Q=='),base64_decode('dXJ'.'sZW'.'5j'.'b2Rl'),base64_decode('Ym'.'l'.'uM'.'mhleA'.'=='),base64_decode('aXNfYXJyYXk='),base64_decode('c'.'3'.'RydG9'.'sb'.'3dlcg'.'='.'='),base64_decode('aXNfYX'.'JyYXk='),base64_decode('am9p'.'bg='.'='),base64_decode('Zm5tYX'.'RjaA'.'=='),base64_decode('c'.'mF3dXJsZ'.'GVj'.'b2Rl'),base64_decode(''.'c3Vic'.'3Ry'),base64_decode('c3Vic3Ry'),base64_decode('c3RyX'.'3J'.'lcGxhY2U'.'='),base64_decode('cH'.'J'.'lZ1'.'9'.'xdW'.'90ZQ'.'=='),base64_decode(''.'cH'.'JlZ19tYXRjaA=='));if(!function_exists(__NAMESPACE__.'\\___410766095')){function ___410766095($_2006076974){static $_1985515035= false; if($_1985515035 == false) $_1985515035=array('Y'.'WN0aW9u','aW50d'.'mFs','cGF0'.'aA==','Y29udG'.'V'.'4d'.'A==','a2V5cw==','cHJvY'.'2Vz'.'c'.'w==',''.'Z'.'W5jb2Rpbmc=','cH'.'JlZ1'.'9yZXB'.'s'.'YWNl','cGF0aA'.'='.'=','Y29ud'.'GV4dA'.'==','a2V5'.'cw'.'==','cHJv'.'Y2'.'Vz'.'cw='.'=','ZW5j'.'b2Rpbmc=','c'.'GF0dGVyb'.'g'.'==','c'.'HJlZ19tYXRjaA==','c'.'GF0aA==','Y29u'.'dG'.'V4d'.'A==','a2V5'.'cw==',''.'cHJvY2Vzcw==','ZW5j'.'b2Rpb'.'mc=','cGF0d'.'GVybg==','cG'.'9zdF9'.'h'.'Y3R'.'pb2'.'4=',''.'Y2hlY2'.'tfY3NyZg='.'=','cGF0'.'a'.'A==','Y29u'.'dGV4dA'.'==',''.'a2V5cw==','cHJvY2'.'Vzcw==',''.'ZW'.'5jb2Rpbmc'.'=','cGF0dGV'.'y'.'bg==','YWN0aW9u','YWN0a'.'W9'.'u','YW'.'N'.'0'.'aW9u','YWN0'.'a'.'W'.'9u','YWN0a'.'W9u','YWN0'.'aW9u','cG9'.'zd'.'F9hY3Rpb'.'24=',''.'ZW5'.'jb'.'2Rpb'.'mc=',''.'ZW5jb2Rpbmc'.'=',''.'ZW5jb2R'.'p'.'bmc=','Z'.'W'.'5jb2Rpbm'.'c=','ZW5j'.'b2R'.'pbmc=','ZW5j'.'b2Rpbmc=',''.'Z3o=','Ym'.'FzZTY0','dXJ'.'s','aGV4','L'.'g==','Lw='.'=','a'.'W5kZ'.'XgucG'.'hw','L'.'2'.'lu'.'ZGV4LnBocA==','U0NSSVBUX0'.'5BTUU=','L2luZGV4LnB'.'ocA==',''.'U0'.'NSSV'.'BUX05BTU'.'U=','U0NSSVBUX05BT'.'UU=','U0NS'.'SV'.'BUX'.'05B'.'TUU=','fg==','fl4=','fg==','XH4'.'=','JH4=');return base64_decode($_1985515035[$_2006076974]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1753679718; protected $_1935681925; protected $_1763346928; protected $_541126877; protected $_1575755036; public static function make(array $_192578464):?static{ $_192578464= static::prepareRuleParameters($_192578464); return match($_192578464[___410766095(0)]){ ___410766095(1) => new IntvalRule( $_192578464[___410766095(2)], $_192578464[___410766095(3)], $_192578464[___410766095(4)], $_192578464[___410766095(5)], $_192578464[___410766095(6)]), ___410766095(7) => new PregReplaceRule( $_192578464[___410766095(8)], $_192578464[___410766095(9)], $_192578464[___410766095(10)], $_192578464[___410766095(11)], $_192578464[___410766095(12)], $_192578464[___410766095(13)]), ___410766095(14) => new PregMatchRule( $_192578464[___410766095(15)], $_192578464[___410766095(16)], $_192578464[___410766095(17)], $_192578464[___410766095(18)], $_192578464[___410766095(19)], $_192578464[___410766095(20)], $_192578464[___410766095(21)]), ___410766095(22) => new CsrfRule( $_192578464[___410766095(23)], $_192578464[___410766095(24)], $_192578464[___410766095(25)], $_192578464[___410766095(26)], $_192578464[___410766095(27)], $_192578464[___410766095(28)],), default => null,};} protected static function prepareRuleParameters(array $_1421130930): array{ if($GLOBALS['____1581458266'][0]($_1421130930[___410766095(29)])){ $_1421130930[___410766095(30)]= $GLOBALS['____1581458266'][1]($_1421130930[___410766095(31)]);} elseif($GLOBALS['____1581458266'][2]($_1421130930[___410766095(32)])){ $_1269603235= $_1421130930[___410766095(33)]; $_1421130930[___410766095(34)]= $_1269603235[(872-2*436)]; $_1421130930[___410766095(35)]= $_1269603235[round(0+0.2+0.2+0.2+0.2+0.2)];} $_1421130930[___410766095(36)]=!empty($_1421130930[___410766095(37)])? $_1421130930[___410766095(38)]:[]; if($GLOBALS['____1581458266'][3]($_1421130930[___410766095(39)])){ $_1421130930[___410766095(40)]=[$_1421130930[___410766095(41)]];} return $_1421130930;}  public function __construct($_1753679718, $_1935681925, $_1763346928, $_541126877, $_1575755036){ $this->_1753679718= $_1753679718; $this->_1935681925= $this->castContext($_1935681925); $this->_1763346928= $this->castKeys($_1763346928); $this->_541126877= $_541126877; $this->_1575755036= $_1575755036;} public function evaluateValue($_146203262){ if(!empty($this->_1575755036)){ foreach($this->_1575755036 as $_779181967){ $_146203262= match($_779181967){ 'gz' => $GLOBALS['____1581458266'][4]($_146203262), 'base64' => $GLOBALS['____1581458266'][5]($_146203262), 'url' => $GLOBALS['____1581458266'][6]($_146203262), 'hex' => hex2bin($_146203262)};}} $_1901419050= $this->evaluate($_146203262); if(!empty($this->_1575755036) && $_1901419050 instanceof ModifyResult){ $_633789779= $_1901419050->getCleanValue(); foreach($GLOBALS['____1581458266'][7]($this->_1575755036) as $_779181967){ $_633789779= match($_779181967){ ___410766095(42) => $GLOBALS['____1581458266'][8]($_633789779), ___410766095(43) => $GLOBALS['____1581458266'][9]($_633789779), ___410766095(44) => $GLOBALS['____1581458266'][10]($_633789779), ___410766095(45) => $GLOBALS['____1581458266'][11]($_633789779)};} $_1901419050= new ModifyResult($_633789779);} return $_1901419050;} abstract public function evaluate($_146203262); protected function castContext($_1935681925){ if(!$GLOBALS['____1581458266'][12]($_1935681925)){ $_1935681925=[$_1935681925];} foreach($_1935681925 as $_1902040660 => $_1159856281){ $_1935681925[$_1902040660]= $GLOBALS['____1581458266'][13]($_1159856281);} return $_1935681925;} protected function castKeys($_1763346928){ if(!$GLOBALS['____1581458266'][14]($_1763346928)){ $_1763346928=[$_1763346928];} return $_1763346928;} public function matchKey(array $_14633532): bool{ $_14633532= $GLOBALS['____1581458266'][15](___410766095(46), $_14633532); foreach($this->_1763346928 as $_1697908817){   if($GLOBALS['____1581458266'][16]($_1697908817, $_14633532)){ return true;}} return false;}  public function matchPath($_1596445731){ if($this->_1753679718 === '*'){ return true;}  $_1187197969= new Uri($_1596445731); $_1551572056= $_1187197969->getPath(); $_1551572056= $GLOBALS['____1581458266'][17]($_1551572056);      if(str_ends_with($_1551572056, ___410766095(47))){ $_1551572056 .= ___410766095(48);} $_1551572056= Path::normalize($_1551572056);  $_1608117412[]= $_1551572056; if(str_ends_with($_1551572056, ___410766095(49))){ $_1608117412[]= $GLOBALS['____1581458266'][18]($_1551572056,(164*2-328),-round(0+4.5+4.5));} elseif(str_ends_with($_SERVER[___410766095(50)], ___410766095(51))){ $_1608117412[]= $GLOBALS['____1581458266'][19]($_SERVER[___410766095(52)],(1464/2-732),-round(0+2.25+2.25+2.25+2.25));} if($_1551572056 !== $_SERVER[___410766095(53)]){ $_1608117412[]= $_SERVER[___410766095(54)];}  if(str_starts_with($this->_1753679718, ___410766095(55))){ $_1978488312= $this->_1753679718;} else{ $_1978488312= ___410766095(56). $GLOBALS['____1581458266'][20](___410766095(57), ___410766095(58), $GLOBALS['____1581458266'][21]($this->_1753679718)). ___410766095(59);} foreach($_1608117412 as $_462276492){ if($this->_1753679718 === $_462276492 || $GLOBALS['____1581458266'][22]($_1978488312, $_462276492)){ return true;}} return false;}  public function getPath(){ return $this->_1753679718;}  public function getContext(){ return $this->_1935681925;}  public function getKeys(){ return $this->_1763346928;}  public function getProcess(){ return $this->_541126877;}}?>